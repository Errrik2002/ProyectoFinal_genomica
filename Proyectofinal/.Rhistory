library(readxl)
library(phyloseq)
library(MGnifyR)
#save(taxa,file="04_Processed_Data/taxa.RData")
load("04_saved/psobj.RData")
rank_names(psobj1)
plot_bar(psobj1, fill = "Genus")
mgclnt <- mgnify_client(usecache = T, cache_dir = '/tmp/MGnify_cache') #esto se conecta a base de dato
#Retrieve the list of analyses associated with a study
accession_list <- mgnify_analyses_from_studies(mgclnt, "MGYS00001373", usecache = T)
#Download all associated study/sample and analysis metadata
meta_dataframe <- mgnify_get_analyses_metadata(mgclnt, accession_list, usecache = T )
#Convert analyses outputs to a single `phyloseq` object
psobj2 <- mgnify_get_analyses_phyloseq(mgclnt, meta_dataframe$analysis_accession, usecache = T)
save(psobj2, file = "04_saved/psobj2.RData")
rank_names(psobj2)
plot_bar(psobj2, fill = "Genus")
psobj2 #lo convierte ya en un objeto phyloseq
rank_names(psobj2)
plot_bar(psobj2, fill = "Species")
plot_bar(psobj2, fill = "Genus")
BiocManager::install("phyloseq")
library(phyloseq)
#save(taxa,file="04_Processed_Data/taxa.RData")
load("04_saved/psobj.RData")
#
plot_net(psobj1, type = "taxa", point_label = "Class", point_size = 10, point_alpha = 0.5, maxdist = 0.5, color = "Species", distance = "bray", laymeth = "auto")
#save(taxa,file="04_Processed_Data/taxa.RData")
load("04_saved/psobj2.RData")
plot_bar(psobj2, fill = "Genus")
script1 <-read.csv("01_RawData/ed1cvs16.tsv",dec=",",sep="\t")
script1
View(script1)
sobreexp <- subset(script1, script1$logFC <0 | script1$P.Value < 0.05)
subexp <- subset(script1, script1$logFC <0 | script1$P.Value < 0.05)
subexp
rm(sobreexp)
sobreexp <- subset(script1, script1$logFC > 0 | script1$P.Value < 0.05)
sobreexp
top10sub <- sort(subexp$logFC, decreasing = F)[1:10]
top10sub
top10sub <- sort(subexp$logFC, decreasing = T)[1:10]
top10sub
elgensub <- subexp %>% filter_all(any_vars(. %in% c(top10sub)[1:10]))
library(dyplr)
library(dplyr)
elgensub <- subexp %>% filter_all(any_vars(. %in% c(top10sub)[1:10]))
elgensub
top10sob <- sort(sobreexp$logFC, decreasing = F)[1:10]
top10sob
elgensobre <- sobreexp %>% filter_all(any_vars(. %in% c(top10sob)[1:10]))
elgensobre
elgensub
vph18 <-read.csv("01_RawData/ed1cvs18.tsv",dec=",",sep="\t")
View(vph18)
subexp18 <- subset(vph18, script1$logFC <0 | script1$P.Value < 0.05)
subexp18
top10sub18 <- sort(subexp18$logFC, decreasing = T)[1:10]
top10sub18
elgensub18 <- subexp18 %>% filter_all(any_vars(. %in% c(top10sub18)[1:10]))
elgensub18
sobreexp18 <- subset(vph18, script1$logFC > 0 | script1$P.Value < 0.05)
sobreexp18
top10sob18 <- sort(sobreexp18$logFC, decreasing = F)[1:10]
elgensobre18 <- sobreexp18 %>% filter_all(any_vars(. %in% c(top10sob18)[1:10]))
elgensobre18
elgensobre18
elgensub18
elgensobre18
elgensobre18
elgensub18
elgensub18
elgensub
elgensobre
